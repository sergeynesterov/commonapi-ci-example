cmake_minimum_required( VERSION 2.8.2 )

project( dlt-daemon-download NONE )

find_package( PkgConfig REQUIRED )
pkg_check_modules( DLT automotive-dlt=${DLT_VERSION} )

if( NOT DLT_FOUND )
   include( ExternalProject )
   ExternalProject_Add( dlt-daemon
      URL               "https://github.com/GENIVI/dlt-daemon/archive/v${DLT_VERSION}.tar.gz"
      PREFIX            "${DLT_VERSION}"
      BINARY_DIR        "${DLT_VERSION}/build/${CMAKE_CXX_COMPILER_ID}-${CMAKE_CXX_COMPILER_VERSION}-${CMAKE_SYSTEM_PROCESSOR}-${CMAKE_BUILD_TYPE}"
      BUILD_COMMAND     "${CMAKE_BUILD_TOOL}" -j $(nproc)
      CMAKE_ARGS        "-DCMAKE_INSTALL_PREFIX=${DLT_ROOT}"
                        "-DCMAKE_BUILD_TYPE=${CMAKE_BUILD_TYPE}"
                        "-DCMAKE_PROJECT_automotive-dlt_INCLUDE=${DLT_DIR}/FIX_CLANG_ERRORS.cmake"
   )
endif()
